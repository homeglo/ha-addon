#!/usr/bin/with-contenv bashio

# Export supervisor token for PHP (let bashio handle the token extraction)
export SUPERVISOR_TOKEN="${SUPERVISOR_TOKEN}"
export HA_TOKEN="${SUPERVISOR_TOKEN}"
export HA_WEBSOCKET_URL="ws://supervisor/core/api/websocket"
export HA_REST_URL="http://supervisor/core/api"

echo "PHP-FPM starting with HA connection vars"
echo "SUPERVISOR_TOKEN present: $([[ -n "$SUPERVISOR_TOKEN" ]] && echo "Yes" || echo "No")"

exec php-fpm83 -F